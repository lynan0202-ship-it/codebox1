/* 
问题8题干：在使用缓冲输入的系统中，把数值和字符混合输入会遇到什么潜在的问题？

知识要点：
1. 缓冲输入机制：scanf和getchar共享同一个输入缓冲区
2. 混合输入问题：
   - scanf读取数值后，换行符残留在缓冲区
   - 后续getchar()会错误读取残留的换行符
3. 解决方案：手动清理缓冲区残留字符

总体逻辑：
1. 复现问题：先读数值再读字符，演示错误行为
2. 解决方案：读完数值后，主动清理缓冲区残留字符
3. 对比两种情况的输出，理解问题本质
*/

#include <stdio.h>

int main() {
    int num;
    char ch;


    // —————— 第一部分：复现问题 ——————
    printf("=== 问题复现：未清理缓冲区 ===\n");
    printf("请输入一个数字和一个字符（例如：10 a）：");
    
    // 步骤1：读取数值（会跳过空白符，但换行符残留）
    scanf("%d", &num);  

    // 步骤2：尝试读取字符（实际读到的是残留的换行符）
    ch = getchar();    

    // 输出结果：字符可能是换行符（ASCII 10），而非预期的 'a'
    printf("你输入的内容：num=%d，char=%c（ASCII值：%d）\n", num, ch, ch);


    // —————— 第二部分：解决方案 ——————
    printf("\n=== 解决方案：清理缓冲区 ===\n");
    printf("请输入一个数字和一个字符（例如：10 a）：");
    
    // 步骤1：读取数值
    scanf("%d", &num);  

    // 关键：清理缓冲区残留的换行符或其他字符
    // 循环读取，直到遇到换行符或文件结束
    while ((ch = getchar()) != '\n' && ch != EOF) {
        // 这里不需要处理字符，只需清空缓冲区
        continue;  
    }

    // 步骤2：正确读取用户输入的字符
    ch = getchar();    

    // 输出结果：字符是预期的内容（例如 'a'）
    printf("你输入的内容：num=%d，char=%c（ASCII值：%d）\n", num, ch, ch);


    return 0;
}