/* 
代码名称：StringFunctionUsageExample
知识要点总结：
1. 掌握strchr函数的用法：查找字符串中指定字符的首次出现位置，返回字符指针或NULL 
2. 理解fgets函数特性：读取指定长度输入（含换行符），缓冲区需留空字符位置 
3. 认识string.h函数参数修饰：const保护源字符串，restrict优化指针别名（代码中体现逻辑，注释解释概念） 
4. 字符串结束符处理：通过替换换行符规范字符串格式 
总体逻辑说明：
1. 定义字符数组line存储输入，指针find接收strchr结果 
2. fgets读取用户输入，最多79有效字符（+1空字符） 
3. strchr查找换行符：找到则替换为'\0'；未找到提示输入超长 
4. 输出处理后字符串，验证结果 
*/

#include <stdio.h>
#include <string.h> // 必须包含，否则strchr未定义

int main(void) {
    char line[80];   // 开辟80字节空间：79字符 + 1个'\0'
    char *find;      // 用于保存strchr的返回值（地址或NULL）

    printf("请输入一行内容（建议长度<80）：");
    fgets(line, 80, stdin); // 从键盘读入，遇到换行/满79字符/EOF停止，会保留换行符

    // strchr功能：在line里找'\n'，找到返回其地址，没找到返回NULL
    find = strchr(line, '\n'); 
    
    if (find != NULL) { // 找到换行符的情况
        *find = '\0';   // 把换行符换成字符串结束符，这样输出时就不会换行
    } else { // 没找到换行符 → 输入内容超过79字符（fgets最多读79，剩下的被截断）
        printf("提示：输入长度超过79，已自动截断！\n");
        // 拓展：可添加代码清空输入缓冲区，避免影响后续输入（简单示例暂不实现）
    }

    printf("处理后的结果：[%s]\n", line); // 输出处理好的字符串，方括号方便观察是否有换行

    return 0;
}

/* 
代码测试及验证建议方案：
1. 正常输入测试：输入"Hello C Language"（短于80字符），检查输出是否去掉换行，格式为[Hello C Language]
2. 超长输入测试：连续输入80个'a'（或更多），检查是否提示截断，且输出前79个'a'
3. 空输入测试：直接按回车，输出应为[]（换行符被替换为'\0'，字符串为空）
4. 调试观察：在if里添加printf("找到换行符，地址：%p\n", find); 看返回的地址是否合理
5. 拓展验证：修改strchr的查找字符（比如找'C'），输入含'C'的字符串，观察find是否指向正确位置 
6. 对比学习：尝试用自定义循环（像教材里的s_gets）实现同样功能，对比strchr的简洁性 
*/